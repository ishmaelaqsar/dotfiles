# A configuration file for spectrwm, designed to integrate with an
# existing XFCE session by replacing the xfwm4 window manager.
# How to use:
#  1. Log in to a normal XFCE session.
#  2. Open a terminal and run spectrwm --replace.
#  3. If it works well, add `spectrwm --replace` to XFCE "Application Autostart" to make it permanent.

# --- Core Settings ---
workspace_limit       = 10    # 10 virtual desktops
focus_mode            = follow
focus_close           = previous
focus_close_wrap      = 1
focus_default         = main
spawn_position        = next
border_width          = 2
color_focus           = rgb:eb/db/b2
color_unfocus         = rgb:83/94/96
region_padding        = 4     # Small gap around the screen edges
tile_gap              = 4     # Small gap between tiled windows

# --- Bar Configuration ---
# We disable the spectrwm bar because we're using the XFCE panel.
bar_enabled           = 0
# For *both* bars, set bar_enabled = 1
# and add a region_padding that matches your XFCE panel height, e.g.:
# region[screen[1]]     = a-24  (if panel is 24px tall at the bottom)

# --- Autostart Programs (via autorun) ---
# We are re-launching the XFCE components that spectrwm will manage.
#
# We prefix with 'ws[1]' to ensure they only launch once on workspace 1.
# The 'sleep 2' gives spectrwm time to settle before launching apps.

autorun = ws[1]:sleep 2; xfce4-panel --disable-wm-check
autorun = ws[1]:sleep 2; xfsettingsd
autorun = ws[1]:sleep 2; xfce4-power-manager
autorun = ws[1]:sleep 2; nm-applet
autorun = ws[1]:sleep 2; /usr/lib/polkit-gnome/polkit-gnome-authentication-agent-1
autorun = ws[1]:sleep 2; picom -b

# --- Program Definitions (for keybindings) ---
# Define the programs we want to launch with keybinds.

program[term]         = xfce4-terminal    # Use the XFCE default terminal
program[launcher]     = xfce4-appfinder   # Use the XFCE app finder
# program[launcher]   = rofi -show drun   # Use the Rofi app finder (alternative)
program[lock]         = xflock4           # Use the XFCE screen locker

# Emacs programs (from your 'emacs-command' script)
program[emacs]        = ~/bin/emacs-command
program[ec_capture]   = ~/bin/emacs-command capture
program[ec_bookmark]  = ~/bin/emacs-command bookmark
program[ec_agenda]    = ~/bin/emacs-command agenda
program[ec_dired]     = ~/bin/emacs-command dired
program[ec_browse]    = ~/bin/emacs-command browse
program[ec_clip]      = ~/bin/emacs-command clip
program[ec_find]      = ~/bin/emacs-command find
program[ec_search]    = ~/bin/emacs-command search
program[ec_roam]      = ~/bin/emacs-command roam
program[ec_daily]     = ~/bin/emacs-command daily
program[ec_magit]     = ~/bin/emacs-command magit
program[ec_mx]        = ~/bin/emacs-command M-x

# Media keys
program[vol_up]       = pactl set-sink-volume @DEFAULT_SINK@ +5%
program[vol_down]     = pactl set-sink-volume @DEFAULT_SINK@ -5%
program[vol_mute]     = pactl set-sink-mute @DEFAULT_SINK@ toggle
program[bright_up]    = brightnessctl set +10%
program[bright_down]  = brightnessctl set 10%-

# Screenshot utilities
program[screenshot]       = xfce4-screenshooter
program[screenshot_full]  = xfce4-screenshooter -f
program[screenshot_area]  = xfce4-screenshooter -r

# --- Keybindings (MOD = Mod4, the "Super" or "Windows" key) ---
MOD = Mod4

# Essential spectrwm keybindings
bind[term]            = MOD+Return
bind[launcher]        = MOD+p
bind[lock]            = MOD+Shift+Delete
bind[quit]            = MOD+Shift+q
bind[restart]         = MOD+q

# Window management
bind[wind_kill]       = MOD+Shift+x
bind[wind_float]      = MOD+t
bind[wind_next]       = MOD+j
bind[wind_prev]       = MOD+k
bind[wind_main]       = MOD+Shift+Return
bind[master_shrink]   = MOD+h
bind[master_grow]     = MOD+l
bind[stack_inc]       = MOD+i
bind[stack_dec]       = MOD+d

# Layout management
bind[cycle_layout]    = MOD+space
bind[layout_vertical] = MOD+v
bind[layout_max]      = MOD+m

# Workspace switching
bind[ws_1]            = MOD+1
bind[ws_2]            = MOD+2
bind[ws_3]            = MOD+3
bind[ws_4]            = MOD+4
bind[ws_5]            = MOD+5
bind[ws_6]            = MOD+6
bind[ws_7]            = MOD+7
bind[ws_8]            = MOD+8
bind[ws_9]            = MOD+9
bind[ws_10]           = MOD+0

# Move window to workspace
bind[mvws_1]          = MOD+Shift+1
bind[mvws_2]          = MOD+Shift+2
bind[mvws_3]          = MOD+Shift+3
bind[mvws_4]          = MOD+Shift+4
bind[mvws_5]          = MOD+Shift+5
bind[mvws_6]          = MOD+Shift+6
bind[mvws_7]          = MOD+Shift+7
bind[mvws_8]          = MOD+Shift+8
bind[mvws_9]          = MOD+Shift+9
bind[mvws_10]         = MOD+Shift+0

# Emacs keybindings (all under MOD+e as a prefix-like approach)
bind[emacs]           = MOD+e
bind[ec_capture]      = MOD+Shift+c
bind[ec_bookmark]     = MOD+Shift+b
bind[ec_agenda]       = MOD+Shift+a
bind[ec_dired]        = MOD+Shift+d
bind[ec_browse]       = MOD+Shift+w
bind[ec_clip]         = MOD+Shift+s
bind[ec_find]         = MOD+Shift+f
bind[ec_search]       = MOD+Shift+g
bind[ec_mx]           = MOD+x

# Media keybindings (these use the special XF86 keys)
bind[vol_up]          = XF86AudioRaiseVolume
bind[vol_down]        = XF86AudioLowerVolume
bind[vol_mute]        = XF86AudioMute
bind[bright_up]       = XF86MonBrightnessUp
bind[bright_down]     = XF86MonBrightnessDown

# Screenshot keybindings
bind[screenshot]      = Print
bind[screenshot_full] = MOD+Print
bind[screenshot_area] = MOD+Shift+Print

# --- Quirks (Window behavior rules) ---
# Make the XFCE panel and appfinder float and not be tiled.
quirk[Xfce4-panel]      = FLOAT + NOFOCUS + FULLSCREEN
quirk[xfce4-appfinder]  = FLOAT
quirk[xfce4-notifyd]    = FLOAT + NOFOCUS
quirk[Xfce4-screenshooter] = FLOAT

# Emacs-specific quirks (uncomment if needed)
# quirk[Emacs:org-capture] = FLOAT
# quirk[Emacs:*Bookmark*]  = FLOAT
